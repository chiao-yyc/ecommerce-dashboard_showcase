# é€šçŸ¥ç³»çµ±æž¶æ§‹èˆ‡è¨­è¨ˆæ–‡ä»¶

## ç³»çµ±å®šä½èˆ‡ç¯„åœ

### ç³»çµ±ç›®æ¨™

æœ¬é€šçŸ¥ç³»çµ±å°ˆç‚º**å¾Œå°ç®¡ç†ç³»çµ±**è¨­è¨ˆï¼Œæœå‹™æ–¼å…§éƒ¨å“¡å·¥çš„å·¥ä½œå”ä½œèˆ‡æ¥­å‹™è™•ç†éœ€æ±‚ã€‚

### æ˜Žç¢ºé‚Šç•Œ

- **âœ… åŒ…å«ç¯„åœ**ï¼šå…§éƒ¨å“¡å·¥å·¥ä½œé€šçŸ¥ã€ç³»çµ±ç›£æŽ§è­¦å ±ã€æ¥­å‹™æµç¨‹é€šçŸ¥
- **âŒ ä¸åŒ…å«ç¯„åœ**ï¼šå®¢æˆ¶ç«¯é€šçŸ¥ã€è¡ŒéŠ·æŽ¨æ’­ã€å¤–éƒ¨ç³»çµ±é€šçŸ¥

### ç”¨æˆ¶å°è±¡

- **ä¸»è¦ç”¨æˆ¶**ï¼šå…§éƒ¨å“¡å·¥ï¼ˆç®¡ç†å“¡ã€éŠ·å”®ã€å®¢æœã€å€‰åº«ã€ITç­‰ï¼‰
- **æ¬¡è¦ç”¨æˆ¶**ï¼šç³»çµ±ç®¡ç†å“¡ã€é–‹ç™¼äººå“¡

## ç³»çµ±æž¶æ§‹è¨­è¨ˆ

### æ ¸å¿ƒæž¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     é€šçŸ¥ç³»çµ±æž¶æ§‹                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ UI å±¤                                                 â”‚
â”‚  â”œâ”€ NotificationList.vue     (é€šçŸ¥åˆ—è¡¨)                     â”‚
â”‚  â”œâ”€ NotificationCard.vue     (é€šçŸ¥å¡ç‰‡)                     â”‚
â”‚  â””â”€ NotificationBadge.vue    (é€šçŸ¥å¾½ç« )                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¥­å‹™é‚è¼¯å±¤                                                 â”‚
â”‚  â”œâ”€ useNotification.ts       (Vue Composable)              â”‚
â”‚  â”œâ”€ NotificationApiService.ts (API æœå‹™)                   â”‚
â”‚  â””â”€ GroupNotificationApiService.ts (ç¾¤çµ„é€šçŸ¥æœå‹™)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è³‡æ–™è™•ç†å±¤                                                 â”‚
â”‚  â”œâ”€ é€šçŸ¥åˆ†é¡žç³»çµ±             (INFORMATIONAL/ACTIONABLE)    â”‚
â”‚  â”œâ”€ å®Œæˆç­–ç•¥ç³»çµ±             (AUTO/SUGGESTED/MANUAL)       â”‚
â”‚  â”œâ”€ ç¾¤çµ„é€šçŸ¥æ©Ÿåˆ¶             (ROLE/DEPARTMENT/BROADCAST)   â”‚
â”‚  â””â”€ æ™ºèƒ½å»ºè­°å¼•æ“Ž             (è‡ªå‹•å»ºè­°å®Œæˆ)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è³‡æ–™åº«å±¤                                                   â”‚
â”‚  â”œâ”€ notifications            (æ ¸å¿ƒé€šçŸ¥è¡¨)                  â”‚
â”‚  â”œâ”€ notification_templates   (é€šçŸ¥æ¨¡æ¿)                    â”‚
â”‚  â”œâ”€ notification_groups      (ç¾¤çµ„å®šç¾©)                    â”‚
â”‚  â”œâ”€ notification_distributions (åˆ†ç™¼è¨˜éŒ„)                 â”‚
â”‚  â””â”€ notification_recipients  (æŽ¥æ”¶è€…è¨˜éŒ„)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è§¸ç™¼å™¨å±¤                                                   â”‚
â”‚  â”œâ”€ è‡ªå‹•è§¸ç™¼å™¨               (Database Triggers)           â”‚
â”‚  â”œâ”€ æ™ºèƒ½å»ºè­°è§¸ç™¼å™¨           (Smart Suggestions)           â”‚
â”‚  â””â”€ æ¥­å‹™é‚è¼¯è§¸ç™¼å™¨           (Business Rules)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒçµ„ä»¶

#### 1. é€šçŸ¥åˆ†é¡žç³»çµ±

```typescript
enum NotificationCategory {
  INFORMATIONAL = 'informational', // è³‡è¨ŠæŽ¨é€ï¼šåªéœ€çŸ¥æ‚‰
  ACTIONABLE = 'actionable', // ä»»å‹™ç®¡ç†ï¼šéœ€è¦è™•ç†
}
```

#### 2. å®Œæˆç­–ç•¥ç³»çµ±

```typescript
enum CompletionStrategy {
  AUTO = 'auto', // è‡ªå‹•å®Œæˆï¼šç³»çµ±ç‹€æ…‹è®Šæ›´è‡ªå‹•å®Œæˆ
  SUGGESTED = 'suggested', // æ™ºèƒ½å»ºè­°ï¼šç³»çµ±å»ºè­°ï¼Œç”¨æˆ¶ç¢ºèª
  MANUAL = 'manual', // ç´”æ‰‹å‹•ï¼šç”¨æˆ¶å®Œå…¨æŽ§åˆ¶
}
```

#### 3. ç¾¤çµ„é€šçŸ¥æ©Ÿåˆ¶

```typescript
enum NotificationTargetType {
  USER = 'user', // å€‹äººé€šçŸ¥
  ROLE = 'role', // è§’è‰²ç¾¤çµ„
  DEPARTMENT = 'department', // éƒ¨é–€ç¾¤çµ„
  BROADCAST = 'broadcast', // å…¨é«”å»£æ’­
  CUSTOM = 'custom', // è‡ªå®šç¾©ç¾¤çµ„
}
```

## è³‡æ–™åº«è¨­è¨ˆ

### æ ¸å¿ƒè¡¨çµæ§‹

#### ä¸»è¦é€šçŸ¥è¡¨ (notifications)

```sql
CREATE TABLE notifications (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL,                    -- æŽ¥æ”¶ç”¨æˆ¶
  type TEXT NOT NULL,                       -- é€šçŸ¥é¡žåž‹
  title TEXT NOT NULL,                      -- é€šçŸ¥æ¨™é¡Œ
  message TEXT NOT NULL,                    -- é€šçŸ¥å…§å®¹
  priority TEXT NOT NULL DEFAULT 'medium', -- å„ªå…ˆç´š
  status TEXT NOT NULL DEFAULT 'unread',   -- ç‹€æ…‹
  channels TEXT[] DEFAULT '{in_app}',       -- ç™¼é€ç®¡é“é™£åˆ—
  metadata JSONB DEFAULT '{}',              -- é¡å¤–è³‡æ–™
  related_entity_type TEXT,                 -- é—œè¯å¯¦é«”é¡žåž‹
  related_entity_id TEXT,                   -- é—œè¯å¯¦é«”ID
  action_url TEXT,                          -- æ“ä½œé€£çµ
  expires_at TIMESTAMP WITH TIME ZONE,     -- éŽæœŸæ™‚é–“
  read_at TIMESTAMP WITH TIME ZONE,        -- å·²è®€æ™‚é–“
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  -- æ–°å¢žåˆ†é¡žå’Œå®Œæˆç­–ç•¥æ¬„ä½ (ä¾†è‡ª 05_notification_categories_fixed.sql)
  category TEXT NOT NULL DEFAULT 'informational', -- åˆ†é¡ž
  completion_strategy TEXT NOT NULL DEFAULT 'manual', -- å®Œæˆç­–ç•¥
  suggested_complete BOOLEAN DEFAULT FALSE, -- æ™ºèƒ½å»ºè­°æ¨™è¨˜
  suggested_at TIMESTAMP WITH TIME ZONE,   -- å»ºè­°æ™‚é–“
  suggestion_reason TEXT,                   -- å»ºè­°åŽŸå› 
  auto_completed_at TIMESTAMP WITH TIME ZONE, -- è‡ªå‹•å®Œæˆæ™‚é–“
  -- ç¾¤çµ„é€šçŸ¥ç›¸é—œæ¬„ä½ (ä¾†è‡ª 08_multi_user_notifications.sql)
  distribution_id UUID,                     -- åˆ†ç™¼è¨˜éŒ„ID
  is_personal BOOLEAN DEFAULT TRUE          -- æ˜¯å¦å€‹äººé€šçŸ¥
);
```

#### ç¾¤çµ„é€šçŸ¥è¡¨ (notification_groups)

```sql
CREATE TABLE notification_groups (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,                       -- ç¾¤çµ„åç¨±
  description TEXT,                         -- ç¾¤çµ„æè¿°
  target_type notification_target_type NOT NULL, -- ç›®æ¨™é¡žåž‹
  target_criteria JSONB NOT NULL,          -- ç¾¤çµ„æ¢ä»¶
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

#### é€šçŸ¥åˆ†ç™¼è¡¨ (notification_distributions)

```sql
CREATE TABLE notification_distributions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  target_type notification_target_type NOT NULL, -- ç›®æ¨™é¡žåž‹
  target_criteria JSONB NOT NULL,          -- åˆ†ç™¼æ¢ä»¶
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);
```

### ç´„æŸèˆ‡ç´¢å¼•

#### è³‡æ–™å®Œæ•´æ€§ç´„æŸ

- **åˆ†é¡žç´„æŸ**ï¼š`category IN ('informational', 'actionable')`
- **å®Œæˆç­–ç•¥ç´„æŸ**ï¼š`completion_strategy IN ('auto', 'suggested', 'manual')`
- **ç‹€æ…‹ç´„æŸ**ï¼š`status IN ('unread', 'read', 'completed', 'dismissed', 'archived')`
- **é€šçŸ¥é¡žåž‹ç´„æŸ**ï¼šç¢ºä¿ `NotificationType` å’Œ `RelatedEntityType` çš„ä¸€è‡´æ€§

#### æ€§èƒ½å„ªåŒ–ç´¢å¼•

```sql
CREATE INDEX idx_notifications_user_status ON notifications(user_id, status);
CREATE INDEX idx_notifications_category ON notifications(category);
CREATE INDEX idx_notifications_completion_strategy ON notifications(completion_strategy);
CREATE INDEX idx_notifications_suggested_complete ON notifications(suggested_complete)
  WHERE suggested_complete = TRUE;
```

## é€šçŸ¥åˆ†é¡žèˆ‡è¦å‰‡

### ç¾æœ‰é€šçŸ¥é¡žåž‹åˆ†æž

#### å¾Œå°ç®¡ç†é€šçŸ¥ï¼ˆ7ç¨®æ ¸å¿ƒé¡žåž‹ï¼‰

1. **ORDER_NEW** - æ–°è¨‚å–®é€šçŸ¥
   - **åˆ†é¡ž**ï¼šACTIONABLE
   - **å®Œæˆç­–ç•¥**ï¼šSUGGESTED
   - **æŽ¥æ”¶è€…**ï¼šéŠ·å”®åœ˜éšŠè§’è‰²
   - **è§¸ç™¼æ¢ä»¶**ï¼šæ–°è¨‚å–®å‰µå»º
   - **è™•ç†å‹•ä½œ**ï¼šè™•ç†è¨‚å–®ã€ç¢ºèªåº«å­˜

2. **ORDER_HIGH_VALUE** - é«˜åƒ¹å€¼è¨‚å–®è­¦ç¤º
   - **åˆ†é¡ž**ï¼šACTIONABLE
   - **å®Œæˆç­–ç•¥**ï¼šMANUAL
   - **æŽ¥æ”¶è€…**ï¼šéŠ·å”®ç¶“ç†è§’è‰²
   - **è§¸ç™¼æ¢ä»¶**ï¼šè¨‚å–®é‡‘é¡ > $10,000
   - **è™•ç†å‹•ä½œ**ï¼šVIPå®¢æˆ¶é—œæ‡·ã€ç‰¹æ®Šè™•ç†

3. **INVENTORY_LOW_STOCK** - ä½Žåº«å­˜è­¦å‘Š
   - **åˆ†é¡ž**ï¼šACTIONABLE
   - **å®Œæˆç­–ç•¥**ï¼šSUGGESTED
   - **æŽ¥æ”¶è€…**ï¼šå€‰åº«ç®¡ç†å“¡è§’è‰²
   - **è§¸ç™¼æ¢ä»¶**ï¼šåº«å­˜ â‰¤ ä½Žåº«å­˜é–¾å€¼
   - **è™•ç†å‹•ä½œ**ï¼šå®‰æŽ’è£œè²¨ã€è¯ç¹«ä¾›æ‡‰å•†

4. **INVENTORY_OUT_OF_STOCK** - ç¼ºè²¨é€šçŸ¥
   - **åˆ†é¡ž**ï¼šACTIONABLE
   - **å®Œæˆç­–ç•¥**ï¼šAUTO
   - **æŽ¥æ”¶è€…**ï¼šå€‰åº«ç®¡ç†å“¡ + æŽ¡è³¼éƒ¨é–€
   - **è§¸ç™¼æ¢ä»¶**ï¼šåº«å­˜ = 0
   - **è™•ç†å‹•ä½œ**ï¼šç·Šæ€¥è£œè²¨ã€æš«åœéŠ·å”®

5. **CUSTOMER_SERVICE_NEW_REQUEST** - æ–°å®¢æœè«‹æ±‚
   - **åˆ†é¡ž**ï¼šACTIONABLE
   - **å®Œæˆç­–ç•¥**ï¼šSUGGESTED
   - **æŽ¥æ”¶è€…**ï¼šå®¢æœåœ˜éšŠè§’è‰²
   - **è§¸ç™¼æ¢ä»¶**ï¼šå®¢æˆ¶æäº¤æœå‹™è«‹æ±‚
   - **è™•ç†å‹•ä½œ**ï¼šåˆ†é…å®¢æœã€å›žè¦†å®¢æˆ¶

6. **CUSTOMER_VIP_ISSUE** - VIPå®¢æˆ¶å•é¡Œ
   - **åˆ†é¡ž**ï¼šACTIONABLE
   - **å®Œæˆç­–ç•¥**ï¼šMANUAL
   - **æŽ¥æ”¶è€…**ï¼šVIPå®¢æœå°ˆå“¡è§’è‰²
   - **è§¸ç™¼æ¢ä»¶**ï¼šVIPå®¢æˆ¶æäº¤å•é¡Œ
   - **è™•ç†å‹•ä½œ**ï¼šå„ªå…ˆè™•ç†ã€ä¸»ç®¡é—œæ³¨

7. **SECURITY_PERMISSION_CHANGED** - æ¬Šé™è®Šæ›´é€šçŸ¥
   - **åˆ†é¡ž**ï¼šINFORMATIONAL
   - **å®Œæˆç­–ç•¥**ï¼šMANUAL
   - **æŽ¥æ”¶è€…**ï¼šè¢«è®Šæ›´ç”¨æˆ¶ + ITç®¡ç†å“¡
   - **è§¸ç™¼æ¢ä»¶**ï¼šç”¨æˆ¶æ¬Šé™è¢«ä¿®æ”¹
   - **è™•ç†å‹•ä½œ**ï¼šç¢ºèªæ¬Šé™è®Šæ›´ã€å®‰å…¨ç›£æŽ§

### é€šçŸ¥è·¯ç”±è¦å‰‡

#### é…ç½®é©…å‹•çš„è·¯ç”±ç³»çµ±

```sql
-- é€šçŸ¥è·¯ç”±é…ç½®è¡¨
CREATE TABLE notification_routing_rules (
  notification_type TEXT PRIMARY KEY,
  target_type notification_target_type NOT NULL,
  target_criteria JSONB NOT NULL,
  send_to_user BOOLEAN DEFAULT FALSE,  -- æ˜¯å¦åŒæ™‚ç™¼é€çµ¦ç›¸é—œç”¨æˆ¶
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- é è¨­è·¯ç”±è¦å‰‡
INSERT INTO notification_routing_rules VALUES
('order_new', 'role', '{"roles": ["sales"]}', FALSE, TRUE),
('order_high_value', 'role', '{"roles": ["sales_manager"]}', FALSE, TRUE),
('inventory_low_stock', 'role', '{"roles": ["warehouse_manager"]}', FALSE, TRUE),
('inventory_out_of_stock', 'role', '{"roles": ["warehouse_manager", "purchasing"]}', FALSE, TRUE),
('customer_service_new_request', 'role', '{"roles": ["customer_service"]}', FALSE, TRUE),
('customer_vip_issue', 'role', '{"roles": ["vip_customer_service"]}', FALSE, TRUE),
('security_permission_changed', 'role', '{"roles": ["it_admin"]}', TRUE, TRUE);
```

## ðŸ¤– æ™ºèƒ½å»ºè­°ç³»çµ±

### æ™ºèƒ½å»ºè­°åŽŸç†

#### 1. è‡ªå‹•å®Œæˆ (AUTO)

ç³»çµ±æª¢æ¸¬åˆ°æ˜Žç¢ºçš„ç‹€æ…‹è®Šæ›´æ™‚ï¼Œè‡ªå‹•å°‡é€šçŸ¥æ¨™è¨˜ç‚ºå·²å®Œæˆã€‚

**ç¯„ä¾‹**ï¼š

- ç¼ºè²¨é€šçŸ¥ â†’ åº«å­˜æ¢å¾©æ™‚è‡ªå‹•å®Œæˆ
- è¨‚å–®å–æ¶ˆé€šçŸ¥ â†’ è¨‚å–®ç‹€æ…‹è®Šæ›´ç‚ºå·²å–æ¶ˆæ™‚è‡ªå‹•å®Œæˆ

#### 2. æ™ºèƒ½å»ºè­° (SUGGESTED)

ç³»çµ±æª¢æ¸¬åˆ°ç›¸é—œæ¥­å‹™ç‹€æ…‹è®Šæ›´æ™‚ï¼Œå»ºè­°ç”¨æˆ¶æ¨™è¨˜é€šçŸ¥ç‚ºå·²å®Œæˆã€‚

**ç¯„ä¾‹**ï¼š

- æ–°è¨‚å–®é€šçŸ¥ â†’ è¨‚å–®ç‹€æ…‹è®Šæ›´ç‚ºå·²å‡ºè²¨æ™‚å»ºè­°å®Œæˆ
- ä½Žåº«å­˜è­¦å‘Š â†’ åº«å­˜è£œå……è¶…éŽé–¾å€¼æ™‚å»ºè­°å®Œæˆ

#### 3. ç´”æ‰‹å‹• (MANUAL)

é‡è¦æˆ–è¤‡é›œçš„é€šçŸ¥ï¼Œå®Œå…¨ç”±ç”¨æˆ¶æŽ§åˆ¶å®Œæˆæ™‚æ©Ÿã€‚

**ç¯„ä¾‹**ï¼š

- é«˜åƒ¹å€¼è¨‚å–® â†’ éœ€è¦äººå·¥ç¢ºèªæ‰€æœ‰è™•ç†æ­¥é©Ÿ
- VIPå®¢æˆ¶å•é¡Œ â†’ éœ€è¦ç¢ºèªå®¢æˆ¶æ»¿æ„åº¦

### æ™ºèƒ½å»ºè­°è§¸ç™¼å™¨

#### åº«å­˜ç›¸é—œå»ºè­°

```sql
-- åº«å­˜è£œå……å»ºè­°
IF NEW.stock > NEW.low_stock_threshold AND OLD.stock <= OLD.low_stock_threshold THEN
  UPDATE notifications
  SET suggested_complete = TRUE,
      suggested_at = NOW(),
      suggestion_reason = 'åº«å­˜å·²è£œå……è‡³ ' || NEW.stock || ' ä»¶'
  WHERE related_entity_type = 'product'
    AND related_entity_id = NEW.id::text
    AND type IN ('inventory_low_stock')
    AND completion_strategy = 'suggested';
END IF;
```

#### è¨‚å–®ç›¸é—œå»ºè­°

```sql
-- è¨‚å–®å‡ºè²¨å»ºè­°
IF NEW.shipping_status = 'shipped' AND OLD.shipping_status != 'shipped' THEN
  UPDATE notifications
  SET suggested_complete = TRUE,
      suggested_at = NOW(),
      suggestion_reason = 'è¨‚å–®å·²å‡ºè²¨'
  WHERE related_entity_type = 'order'
    AND related_entity_id = NEW.id::text
    AND type IN ('order_new', 'order_high_value')
    AND completion_strategy = 'suggested';
END IF;
```

## ðŸ”„ é€šçŸ¥ç”Ÿå‘½é€±æœŸ

### ç‹€æ…‹è½‰æ›åœ–

```
UNREAD â†’ READ â†’ COMPLETED (ACTIONABLE)
               â†“
             DISMISSED (INFORMATIONAL)
               â†“
            ARCHIVED
```

### ç‹€æ…‹èªªæ˜Ž

- **UNREAD**ï¼šæœªè®€ç‹€æ…‹ï¼Œç”¨æˆ¶å°šæœªæŸ¥çœ‹
- **READ**ï¼šå·²è®€ç‹€æ…‹ï¼Œç”¨æˆ¶å·²æŸ¥çœ‹ä½†æœªè™•ç†
- **COMPLETED**ï¼šå·²å®Œæˆç‹€æ…‹ï¼Œåƒ…é©ç”¨æ–¼ ACTIONABLE é€šçŸ¥
- **DISMISSED**ï¼šå·²çŸ¥æ‚‰ç‹€æ…‹ï¼Œåƒ…é©ç”¨æ–¼ INFORMATIONAL é€šçŸ¥
- **ARCHIVED**ï¼šå·²æ­¸æª”ç‹€æ…‹ï¼Œä¸å†é¡¯ç¤ºåœ¨ä¸»è¦åˆ—è¡¨ä¸­

### æ“ä½œæµç¨‹

#### è³‡è¨Šåž‹é€šçŸ¥æµç¨‹

1. **ç³»çµ±è§¸ç™¼** â†’ å‰µå»º UNREAD é€šçŸ¥
2. **ç”¨æˆ¶æŸ¥çœ‹** â†’ ç‹€æ…‹è®Šæ›´ç‚º READ
3. **ç”¨æˆ¶æ“ä½œ** â†’ é»žæ“Šã€Œå·²çŸ¥æ‚‰ã€â†’ ç‹€æ…‹è®Šæ›´ç‚º DISMISSED
4. **ç³»çµ±æ¸…ç†** â†’ å®šæœŸå°‡èˆŠé€šçŸ¥æ­¸æª”ç‚º ARCHIVED

#### ä»»å‹™åž‹é€šçŸ¥æµç¨‹

1. **ç³»çµ±è§¸ç™¼** â†’ å‰µå»º UNREAD é€šçŸ¥
2. **ç”¨æˆ¶æŸ¥çœ‹** â†’ ç‹€æ…‹è®Šæ›´ç‚º READ
3. **æ™ºèƒ½å»ºè­°** â†’ ç³»çµ±æª¢æ¸¬ç‹€æ…‹è®Šæ›´ï¼Œè¨­ç½® suggested_complete = TRUE
4. **ç”¨æˆ¶ç¢ºèª** â†’ æŽ¥å—å»ºè­°æˆ–æ‰‹å‹•æ¨™è¨˜ â†’ ç‹€æ…‹è®Šæ›´ç‚º COMPLETED
5. **ç³»çµ±æ¸…ç†** â†’ å®šæœŸå°‡èˆŠé€šçŸ¥æ­¸æª”ç‚º ARCHIVED

## ðŸ“ˆ æ€§èƒ½èˆ‡æ“´å±•è¨­è¨ˆ

### æ€§èƒ½å„ªåŒ–ç­–ç•¥

#### 1. è³‡æ–™åº«å±¤ç´šå„ªåŒ–

- **ç´¢å¼•ç­–ç•¥**ï¼šé‡å°å¸¸ç”¨æŸ¥è©¢å»ºç«‹è¤‡åˆç´¢å¼•
- **åˆ†å€ç­–ç•¥**ï¼šæŒ‰æ™‚é–“åˆ†å€å­˜å„²æ­·å²é€šçŸ¥
- **æ¸…ç†ç­–ç•¥**ï¼šå®šæœŸæ¸…ç†éŽæœŸé€šçŸ¥å’Œå»ºè­°

#### 2. æ‡‰ç”¨å±¤ç´šå„ªåŒ–

- **å¿«å–ç­–ç•¥**ï¼šå¸¸ç”¨é€šçŸ¥æ•¸æ“šå¿«å–
- **æ‰¹é‡æ“ä½œ**ï¼šç¾¤çµ„é€šçŸ¥æ‰¹é‡å‰µå»º
- **ç•°æ­¥è™•ç†**ï¼šå¤§é‡é€šçŸ¥ç•°æ­¥åˆ†ç™¼

#### 3. å‰ç«¯å±¤ç´šå„ªåŒ–

- **è™›æ“¬æ»¾å‹•**ï¼šå¤§é‡é€šçŸ¥åˆ—è¡¨è™›æ“¬åŒ–
- **å¯¦æ™‚æ›´æ–°**ï¼šWebSocket æˆ– Server-Sent Events
- **æœ¬åœ°å¿«å–**ï¼šé€šçŸ¥ç‹€æ…‹æœ¬åœ°å¿«å–

### æ“´å±•æ€§è¨­è¨ˆ

#### 1. é€šçŸ¥é¡žåž‹æ“´å±•

- **æ¨¡æ¿ç³»çµ±**ï¼šæ–°å¢žé€šçŸ¥é¡žåž‹çš„æ¨™æº–åŒ–æµç¨‹
- **æ’ä»¶æ©Ÿåˆ¶**ï¼šæ”¯æ´ç¬¬ä¸‰æ–¹é€šçŸ¥æ’ä»¶
- **é…ç½®ç®¡ç†**ï¼šé€šçŸ¥è¦å‰‡å‹•æ…‹é…ç½®

#### 2. é€šé“æ“´å±•

- **å¤šé€šé“æ”¯æ´**ï¼šIn-Appã€Emailã€SMSã€Push
- **é€šé“ç­–ç•¥**ï¼šæ ¹æ“šå„ªå…ˆç´šå’Œç”¨æˆ¶åå¥½é¸æ“‡é€šé“
- **å¤–éƒ¨æ•´åˆ**ï¼šæ”¯æ´ç¬¬ä¸‰æ–¹é€šçŸ¥æœå‹™

#### 3. åˆ†æ•£å¼éƒ¨ç½²

- **å¾®æœå‹™æž¶æ§‹**ï¼šé€šçŸ¥æœå‹™ç¨ç«‹éƒ¨ç½²
- **æ¶ˆæ¯éšŠåˆ—**ï¼šä½¿ç”¨ Redis/RabbitMQ è™•ç†é«˜ä¸¦ç™¼
- **è² è¼‰å‡è¡¡**ï¼šæ”¯æ´æ°´å¹³æ“´å±•

## å®‰å…¨æ€§è€ƒæ…®

### è³‡æ–™å®‰å…¨

- **æ¬Šé™æŽ§åˆ¶**ï¼šç”¨æˆ¶åªèƒ½æŸ¥çœ‹è‡ªå·±çš„é€šçŸ¥
- **è³‡æ–™åŠ å¯†**ï¼šæ•æ„Ÿé€šçŸ¥å…§å®¹åŠ å¯†å­˜å„²
- **å¯©è¨ˆæ—¥èªŒ**ï¼šå®Œæ•´çš„é€šçŸ¥æ“ä½œè¨˜éŒ„

### ç³»çµ±å®‰å…¨

- **è¼¸å…¥é©—è­‰**ï¼šæ‰€æœ‰é€šçŸ¥å…§å®¹åš´æ ¼é©—è­‰
- **XSSé˜²è­·**ï¼šé€šçŸ¥å…§å®¹ HTML è½‰ç¾©
- **CSRFä¿è­·**ï¼šé€šçŸ¥æ“ä½œ CSRF Token é©—è­‰

### éš±ç§ä¿è­·

- **è³‡æ–™æœ€å°åŒ–**ï¼šåªæ”¶é›†å¿…è¦çš„é€šçŸ¥è³‡æ–™
- **ä¿ç•™æ”¿ç­–**ï¼šå®šæœŸæ¸…ç†éŽæœŸé€šçŸ¥
- **åŒ¿ååŒ–è™•ç†**ï¼šæ­·å²æ•¸æ“šåŒ¿ååŒ–

## ðŸ§ª æ¸¬è©¦ç­–ç•¥

### å–®å…ƒæ¸¬è©¦

- **æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦**ï¼šé€šçŸ¥ CRUD æ“ä½œ
- **æ¥­å‹™é‚è¼¯æ¸¬è©¦**ï¼šåˆ†é¡žã€å®Œæˆç­–ç•¥é‚è¼¯
- **ç´„æŸé©—è­‰æ¸¬è©¦**ï¼šè³‡æ–™å®Œæ•´æ€§ç´„æŸ

### æ•´åˆæ¸¬è©¦

- **è§¸ç™¼å™¨æ¸¬è©¦**ï¼šå„ç¨®æ¥­å‹™è§¸ç™¼å™¨
- **APIæ¸¬è©¦**ï¼šé€šçŸ¥æœå‹™ API ç«¯é»ž
- **ç¾¤çµ„é€šçŸ¥æ¸¬è©¦**ï¼šç¾¤çµ„åˆ†ç™¼é‚è¼¯

### ç«¯åˆ°ç«¯æ¸¬è©¦

- **ç”¨æˆ¶æµç¨‹æ¸¬è©¦**ï¼šå®Œæ•´çš„é€šçŸ¥è™•ç†æµç¨‹
- **æ€§èƒ½æ¸¬è©¦**ï¼šå¤§é‡é€šçŸ¥è™•ç†æ€§èƒ½
- **å¯é æ€§æ¸¬è©¦**ï¼šç³»çµ±ç•°å¸¸æƒ…æ³è™•ç†

## éƒ¨ç½²èˆ‡ç¶­è­·

### éƒ¨ç½²ç­–ç•¥

- **æ¼¸é€²å¼éƒ¨ç½²**ï¼šåˆ†éšŽæ®µä¸Šç·šæ–°åŠŸèƒ½
- **è—ç¶ éƒ¨ç½²**ï¼šé›¶åœæ©Ÿæ›´æ–°
- **å›žæ»¾æ©Ÿåˆ¶**ï¼šå¿«é€Ÿå›žæ»¾ç•°å¸¸ç‰ˆæœ¬

### ç›£æŽ§èˆ‡å‘Šè­¦

- **æ€§èƒ½ç›£æŽ§**ï¼šé€šçŸ¥è™•ç†æ™‚é–“å’ŒæˆåŠŸçŽ‡
- **æ¥­å‹™ç›£æŽ§**ï¼šé€šçŸ¥åˆ†ç™¼çµ±è¨ˆå’Œç”¨æˆ¶è¡Œç‚º
- **ç³»çµ±å‘Šè­¦**ï¼šç•°å¸¸æƒ…æ³å³æ™‚å‘Šè­¦

### ç¶­è­·æŒ‡å—

- **è³‡æ–™åº«ç¶­è­·**ï¼šå®šæœŸæ¸…ç†ã€ç´¢å¼•å„ªåŒ–
- **é…ç½®ç®¡ç†**ï¼šé€šçŸ¥è¦å‰‡ç‰ˆæœ¬æŽ§åˆ¶
- **æ•…éšœæŽ’é™¤**ï¼šå¸¸è¦‹å•é¡Œè¨ºæ–·æŒ‡å—

---

## ç¸½çµ

æœ¬é€šçŸ¥ç³»çµ±æŽ¡ç”¨åˆ†å±¤æž¶æ§‹è¨­è¨ˆï¼Œå°ˆæ³¨æ–¼å¾Œå°ç®¡ç†éœ€æ±‚ï¼Œæä¾›ï¼š

1. **æ™ºèƒ½åˆ†é¡ž**ï¼šINFORMATIONAL/ACTIONABLE é›™é‡åˆ†é¡ž
2. **æ™ºèƒ½å»ºè­°**ï¼šAUTO/SUGGESTED/MANUAL ä¸‰å±¤å®Œæˆç­–ç•¥
3. **ç¾¤çµ„é€šçŸ¥**ï¼šè§’è‰²ã€éƒ¨é–€ã€å»£æ’­å¤šç¨®åˆ†ç™¼æ–¹å¼
4. **æ“´å±•æ€§**ï¼šæ¨¡çµ„åŒ–è¨­è¨ˆï¼Œæ˜“æ–¼æ“´å±•å’Œç¶­è­·
5. **é«˜æ€§èƒ½**ï¼šå„ªåŒ–çš„è³‡æ–™åº«è¨­è¨ˆå’Œå¿«å–ç­–ç•¥

ç³»çµ±è¨­è¨ˆéµå¾ª**ç°¡å–®ã€å¯é ã€é«˜æ•ˆ**çš„åŽŸå‰‡ï¼Œç‚ºå…§éƒ¨å”ä½œæä¾›å¼·æœ‰åŠ›çš„é€šçŸ¥æ”¯æ’ã€‚
