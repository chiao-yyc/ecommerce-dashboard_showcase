# ğŸª E-commerce Admin Platform

> ä¼æ¥­ç´šé›»å•†ç®¡ç†å¾Œå°ç³»çµ± - æ•´åˆè¨‚å–®ç®¡ç†ã€å®¢æˆ¶åˆ†æã€æ™ºèƒ½é€šçŸ¥ã€æ´»å‹•æ­¸å› çš„å…¨æ–¹ä½è§£æ±ºæ–¹æ¡ˆ

ä¸€å€‹æ¡ç”¨ **Vue 3 + TypeScript + Supabase** å»ºç«‹çš„ç¾ä»£åŒ–é›»å•†å¾Œå°ç®¡ç†ç³»çµ±ï¼Œå±•ç¤ºä¼æ¥­ç´šå‰ç«¯æ¶æ§‹è¨­è¨ˆã€ç‹€æ…‹ç®¡ç†æ¨¡å¼ã€å³æ™‚é€šè¨Šæ•´åˆå’Œè³‡æ–™åˆ†æèƒ½åŠ›ã€‚

**æ ¸å¿ƒç‰¹è‰²**: ServiceFactory ä¾è³´æ³¨å…¥æ¨¡å¼ Â· æ™ºèƒ½é€šçŸ¥ç³»çµ± Â· æ´»å‹•åˆ†å±¤æ­¸å› åˆ†æ Â· Realtime è¨‚é–± Â· RFM å®¢æˆ¶åˆ†ç¾¤

---

## ğŸš€ Live Demo

**ç·šä¸Šå±•ç¤º**: [https://ecadmin.yachiaoyang.dev/](https://ecadmin.yachiaoyang.dev) *(éƒ¨ç½²ä¸­)*

### æ¸¬è©¦å¸³è™Ÿ

| è§’è‰² | å¸³è™Ÿ | å¯†ç¢¼ | æ¬Šé™èªªæ˜ |
|------|------|------|----------|
| è¶…ç´šç®¡ç†å“¡ | admin@demo.com | demo1234 | å®Œæ•´ç³»çµ±æ¬Šé™ã€è§’è‰²ç®¡ç† |
| æ¥­å‹™ç¶“ç† | manager@demo.com | demo1234 | è¨‚å–®ç®¡ç†ã€å®¢æˆ¶åˆ†æ |
| å®¢æœäººå“¡ | support@demo.com | demo1234 | å·¥å–®ç³»çµ±ã€é€šçŸ¥ä¸­å¿ƒ |

> å»ºè­°å…ˆç”¨è¶…ç´šç®¡ç†å“¡å¸³è™Ÿé«”é©—å®Œæ•´åŠŸèƒ½ï¼Œå†åˆ‡æ›å…¶ä»–è§’è‰²æŸ¥çœ‹æ¬Šé™æ§åˆ¶æ•ˆæœ

---

## âœ¨ æ ¸å¿ƒç‰¹è‰²

### æŠ€è¡“äº®é»

- **ServiceFactory ä¾è³´æ³¨å…¥æ¨¡å¼** - é¬†è€¦åˆæ¶æ§‹è¨­è¨ˆï¼Œæ”¯æ´æ¸¬è©¦èˆ‡ç’°å¢ƒéš”é›¢
- **æ™ºèƒ½é€šçŸ¥ç³»çµ±** - PostgreSQL è§¸ç™¼å™¨ + Realtime æ¨é€ + æ™ºèƒ½å»ºè­°é‚è¼¯
- **æ´»å‹•åˆ†å±¤æ­¸å› åˆ†æ** - å¤šè§¸é»æ­¸å› æ¬Šé‡è¨ˆç®—ï¼Œä¸‰å±¤æ­¸å› åˆ†é¡ï¼ˆprimary/secondary/tertiaryï¼‰
- **RFM å®¢æˆ¶åˆ†ç¾¤** - åŸºæ–¼ Recencyã€Frequencyã€Monetary çš„å®¢æˆ¶åƒ¹å€¼è©•ä¼°
- **å³æ™‚è³‡æ–™è¨‚é–±** - Supabase Realtime æ•´åˆï¼Œè¨‚å–®/åº«å­˜/é€šçŸ¥å³æ™‚æ›´æ–°
- **å®Œæ•´ä¸»é¡Œç³»çµ±** - Dark/Light æ¨¡å¼ï¼ŒCSS è®Šæ•¸çµ±ä¸€ç®¡ç†

### æ¥­å‹™åŠŸèƒ½

- **è¨‚å–®ç®¡ç†** - å®Œæ•´ç”Ÿå‘½é€±æœŸç®¡ç†ã€ç‹€æ…‹æ©Ÿè¨­è¨ˆã€æ‰¹é‡æ“ä½œ
- **å®¢æˆ¶åˆ†æ** - RFM åˆ†ç¾¤ã€è¡Œç‚ºè¿½è¹¤ã€æµå¤±é¢¨éšªé è­¦
- **ç”¢å“ç®¡ç†** - ABC åˆ†æã€æ»¯éŠ·å“åˆ†æã€åº«å­˜é è­¦
- **æ´»å‹•åˆ†æ** - ç¸½è¦½/æ­¸å› /å”ä½œ/é‡ç–Š/è¶¨å‹¢åˆ†æï¼Œ6 å¤§åˆ†æç¶­åº¦
- **é€šçŸ¥ç³»çµ±** - ç¾¤çµ„é€šçŸ¥ã€æ¨¡æ¿ç®¡ç†ã€æ™ºèƒ½å»ºè­°
- **å·¥å–®ç³»çµ±** - å®¢æœå°è©±ã€å·¥å–®è¿½è¹¤ã€SLA ç®¡ç†
- **æ¬Šé™ç®¡ç†** - è§’è‰²æ¬Šé™æ§åˆ¶ã€RLS è¡Œç´šå®‰å…¨ç­–ç•¥

---

## ğŸ› ï¸ æŠ€è¡“æ£§

### å‰ç«¯æ ¸å¿ƒ

- **æ¡†æ¶**: Vue 3.5 (Composition API)
- **èªè¨€**: TypeScript 5.x (åš´æ ¼æ¨¡å¼)
- **å»ºç½®å·¥å…·**: Vite 6.0
- **ç‹€æ…‹ç®¡ç†**: Pinia + Vue Query
- **è·¯ç”±**: Vue Router 4.x

### UI/UX

- **æ¨£å¼ç³»çµ±**: Tailwind CSS 3.x + SCSS
- **çµ„ä»¶åº«**: Radix Vue (Headless UI)
- **åœ–è¡¨**: Unovis (éŸ¿æ‡‰å¼è³‡æ–™è¦–è¦ºåŒ–)
- **åœ–ç¤º**: Lucide Icons
- **å‹•ç•«**: è‡ªå®šç¾© CSS å‹•ç•«ç³»çµ±

### å¾Œç«¯æ•´åˆ

- **BaaS**: Supabase (PostgreSQL + Realtime + Auth)
- **API å±¤**: ServiceFactory ä¾è³´æ³¨å…¥æ¨¡å¼
- **å³æ™‚é€šè¨Š**: Supabase Realtime Subscriptions
- **è³‡æ–™æŸ¥è©¢**: Vue Query (å¿«å–ç­–ç•¥)

### é–‹ç™¼å·¥å…·

- **æ¸¬è©¦**: Vitest + Vue Test Utils (471 æ¸¬è©¦å…¨éƒ¨é€šé)
- **ç¨‹å¼ç¢¼å“è³ª**: ESLint + Prettier
- **é¡å‹æª¢æŸ¥**: Vue TSC
- **æ–‡ä»¶**: VitePress
- **Git Hooks**: Husky (pre-commit æª¢æŸ¥)

### æ¶æ§‹ç‰¹è‰²

- **ä¾è³´æ³¨å…¥**: ServiceFactory Pattern
- **ç‹€æ…‹æ©Ÿ**: è¨‚å–®ç‹€æ…‹æ©Ÿè¨­è¨ˆ
- **åˆ†å±¤æ¶æ§‹**: View â†’ Component â†’ Service â†’ Database
- **éŒ¯èª¤è™•ç†**: ä¸‰å±¤éŒ¯èª¤è™•ç†æ¶æ§‹

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹

### æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vue 3 + TypeScript                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Views Layer   â”‚  Components    â”‚   Composables     â”‚
â”‚  (é é¢çµ„ä»¶)      â”‚  (æ¥­å‹™/UIçµ„ä»¶)  â”‚   (æ¥­å‹™é‚è¼¯)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               ServiceFactory (ä¾è³´æ³¨å…¥å±¤)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ UserService â”‚ OrderService â”‚ NotificationSvs â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               Supabase Client (BaaS)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ PostgreSQL â”‚ Realtime â”‚ Auth â”‚ RLS Policies  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ServiceFactory ä¾è³´æ³¨å…¥æ¨¡å¼

```
@/lib/supabase.ts (è¨­å®šå¯¦ä¾‹)
    â†“
services/index.ts (å»ºç«‹ defaultServiceFactory)
    â†“
ServiceFactory (ç®¡ç†æœå‹™å¯¦ä¾‹)
    â†“ â†“ â†“
UserService  OrderService  NotificationService
    â†“ â†“ â†“
Composables (æ¥­å‹™é‚è¼¯å±¤)
    â†“ â†“ â†“
Views & Components (UI å±¤)
```

**è¨­è¨ˆå„ªå‹¢**:
- **é¬†è€¦åˆ** - æœå‹™å±¤èˆ‡å¯¦ä¾‹åŒ–é‚è¼¯åˆ†é›¢
- **å¯æ¸¬è©¦** - è¼•é¬†æ³¨å…¥ Mock é€²è¡Œå–®å…ƒæ¸¬è©¦
- **ç’°å¢ƒéš”é›¢** - é–‹ç™¼/æ¸¬è©¦/ç”Ÿç”¢ç’°å¢ƒç¨ç«‹è¨­å®š
- **å–®ä¾‹ç®¡ç†** - æœå‹™å¯¦ä¾‹çµ±ä¸€ç®¡ç†ï¼Œé¿å…é‡è¤‡å»ºç«‹

### é€šçŸ¥ç³»çµ±æ¶æ§‹æµç¨‹

```
æ¥­å‹™äº‹ä»¶è§¸ç™¼ (è¨‚å–®/åº«å­˜/å®¢æˆ¶)
    â†“
PostgreSQL Triggers (notify_order_events, notify_inventory_events)
    â†“
INSERT INTO notifications (é€šçŸ¥è¨˜éŒ„å­˜å…¥è³‡æ–™è¡¨)
    â†“
æ™ºèƒ½å»ºè­°é‚è¼¯åˆ¤æ–· (suggest_completion å‡½æ•¸)
    â†“
é€šçŸ¥æ¨¡æ¿æ¸²æŸ“ (8 å€‹ç³»çµ±å¿…è¦æ¨¡æ¿)
    â†“
Supabase Realtime æ¨é€ (è¨‚é–± notifications è¡¨)
    â†“
å‰ç«¯ NotificationBadge æ›´æ–° (useNotification composable)
```

### æ´»å‹•æ­¸å› åˆ†æè³‡æ–™æµ

```
è¨‚å–®èˆ‡æ´»å‹•æ¥è§¸è¨˜éŒ„ (orders, order_items, campaigns)
    â†“
å¤šè§¸é»æ­¸å› é‚è¼¯åˆ¤æ–· (site-wide/target-oriented/category-specific åˆ†å±¤)
    â†“
æ¬Šé‡è¨ˆç®—èˆ‡ç‡Ÿæ”¶åˆ†é… (normalized_weight Â· attributed_revenue)
    â†“
revenue_attribution_analysis (PostgreSQL åˆ†æè¦–åœ–)
    â†“
CampaignApiService (API å±¤æŸ¥è©¢)
    â†“
useCampaignAnalyticsQueries (Vue Query å¿«å–)
    â†“
è¦–è¦ºåŒ–åˆ†æå ±è¡¨ (æ­¸å› åˆ†æ Â· å”ä½œæ•ˆæœ Â· é‡ç–Šæ—¥æ›† Â· è¶¨å‹¢é æ¸¬ç­‰)
```

---

## ğŸ’¡ è§£æ±ºçš„æŠ€è¡“æŒ‘æˆ°

### æŒ‘æˆ° 1: é€šçŸ¥ç³»çµ±å¾é›¶åŠŸèƒ½åˆ° 100% æ¢å¾©

**å•é¡ŒèƒŒæ™¯**:
å°ˆæ¡ˆç¹¼æ‰¿æ™‚ç™¼ç¾é€šçŸ¥ç³»çµ±å‰ç«¯å®Œæ•´ä½†å¾Œç«¯è§¸ç™¼å™¨å®Œå…¨å¤±æ•ˆï¼Œç”¢å“å’Œå®¢æˆ¶é€šçŸ¥ç„¡æ³•è§¸ç™¼ï¼Œå½±éŸ¿æ ¸å¿ƒæ¥­å‹™æµç¨‹ã€‚

**æ ¹å› åˆ†æ**:
1. è§¸ç™¼å™¨ç¶å®šåˆ° mock è¡¨è€Œéå¯¦éš›æ¥­å‹™è¡¨
2. ç”¢å“/å®¢æˆ¶é€šçŸ¥è·¯ç”±è¦å‰‡ç¼ºå¤±
3. é€šçŸ¥æ¨¡æ¿å¯¦é«”é¡å‹ç´„æŸéŒ¯èª¤
4. ç¼ºå°‘ç³»çµ±æ¨¡æ¿ä¿è­·æ©Ÿåˆ¶

**è§£æ±ºæ–¹æ¡ˆ**ï¼ˆ4 éšæ®µä¿®å¾©ï¼‰:

1. **Phase 1: é‡å¯«è§¸ç™¼å™¨æ¶æ§‹**
   - å°‡è§¸ç™¼å™¨å¾ mock è¡¨ç¶å®šåˆ°å¯¦éš›æ¥­å‹™è¡¨ï¼ˆordersã€productsã€customersï¼‰
   - å¯¦ä½œåŸºæ–¼è·¯ç”±è¦å‰‡çš„é€šçŸ¥è‡ªå‹•æ’å…¥é‚è¼¯
   - æ•´åˆæ™ºèƒ½å»ºè­°é‚è¼¯ï¼šè¨‚å–®ç‹€æ…‹è®Šæ›´è‡ªå‹•è§¸ç™¼ç›¸é—œé€šçŸ¥å®Œæˆå»ºè­°

2. **Phase 2: è£œé½Šè·¯ç”±è¦å‰‡**
   - æ–°å¢ 7 ç¨®é€šçŸ¥é¡å‹çš„è§’è‰²æ˜ å°„è¦å‰‡
   - ç¢ºä¿ä¸åŒè§’è‰²çœ‹åˆ°å°æ‡‰çš„é€šçŸ¥

3. **Phase 3: ä¿®æ­£æ¨¡æ¿å¯¦é«”é¡å‹ç´„æŸ**
   - æ›´æ–°é€šçŸ¥æ¨¡æ¿çš„ `required_entity_type` æ¬„ä½
   - ä¿®æ­£ product/customer/inventory é€šçŸ¥çš„å¯¦é«”é¡å‹

4. **Phase 4: å»ºç«‹ç³»çµ±æ¨¡æ¿ä¿è­·æ©Ÿåˆ¶**
   - æ¨™è¨˜ 8 å€‹æ ¸å¿ƒæ¨¡æ¿ç‚º `is_system_required`
   - å¯¦ä½œå¤šå±¤è§¸ç™¼å™¨é˜²æ­¢æ„å¤–åˆªé™¤æˆ–åœç”¨
   - æ·»åŠ  RLS æ”¿ç­–é™åˆ¶ä¿®æ”¹æ¬Šé™

**æŸ¥çœ‹å®Œæ•´å¯¦ä½œ**: `supabase/migrations/20250731170000_fix_notification_triggers_for_real_tables.sql`

**ä¿®å¾©æˆæœ**:
- è¨‚å–®é€šçŸ¥: 0% â†’ 100%
- ç”¢å“é€šçŸ¥: 0% â†’ 100%
- å®¢æˆ¶é€šçŸ¥: 0% â†’ 100%
- å»ºè­°ç³»çµ±: å®Œæ•´çš„æ™ºèƒ½å®Œæˆå»ºè­°é‚è¼¯
- ç³»çµ±ä¿è­·: 8 å€‹æ ¸å¿ƒæ¨¡æ¿å—åˆ°å¤šå±¤ä¿è­·

**ç›¸é—œæ–‡ä»¶**: [é€šçŸ¥ç³»çµ±æ¦‚è¿°](./docs/04-guides/dev-notes/NOTIFICATION_SYSTEM_OVERVIEW.md)

---

### æŒ‘æˆ° 2: Router Session æ•ˆèƒ½æœ€ä½³åŒ–

**å•é¡ŒèƒŒæ™¯**:
åˆå§‹åŒ–æ™‚ `useRouterSession` çš„ `computeRecentRoutes()` è¨ˆç®—è€—æ™‚ 3 ç§’ï¼Œå°è‡´é¦–é è¼‰å…¥ç·©æ…¢ã€‚

**æ•ˆèƒ½ç“¶é ¸åˆ†æ**:

```typescript
//å•é¡Œç¨‹å¼ç¢¼ï¼šæ¯æ¬¡éƒ½é‡æ–°è¨ˆç®—æ•´å€‹ sessionStorage
watch(
  () => router.currentRoute.value,
  () => {
    computeRecentRoutes()  // 3 ç§’è€—æ™‚æ“ä½œ
  },
  { immediate: true }
)
```

**æ ¹å› è­˜åˆ¥**:
1. **immediate: true** å°è‡´çµ„ä»¶æ›è¼‰æ™‚ç«‹å³åŸ·è¡Œ
2. **sessionStorage éæ­·** - 500+ æ¢è·¯ç”±è¨˜éŒ„å®Œæ•´éæ­·
3. **é‡è¤‡è¨ˆç®—** - æœªä½¿ç”¨å¿«å–ï¼Œæ¯æ¬¡è·¯ç”±è®Šæ›´é‡æ–°è¨ˆç®—
4. **åŒæ­¥é˜»å¡** - è¨ˆç®—éç¨‹é˜»å¡ä¸»åŸ·è¡Œç·’

**æœ€ä½³åŒ–æ–¹æ¡ˆ**:

```typescript
// âœ… æœ€ä½³åŒ–å¾Œï¼šæ‡¶è¼‰å…¥ + å¿«å–ç­–ç•¥
const recentRoutes = ref<RouteRecord[]>([])
let cacheTimestamp = 0
const CACHE_DURATION = 5 * 60 * 1000  // 5 åˆ†é˜å¿«å–

function computeRecentRoutes() {
  // å¿«å–æª¢æŸ¥
  if (Date.now() - cacheTimestamp < CACHE_DURATION) {
    return recentRoutes.value
  }

  // éåŒæ­¥è¨ˆç®—
  requestIdleCallback(() => {
    const routes = parseSessionStorage()
    recentRoutes.value = routes.slice(0, 10)  // åªå–å‰ 10 ç­†
    cacheTimestamp = Date.now()
  })
}

// ç§»é™¤ immediate: trueï¼Œæ”¹ç‚ºéœ€è¦æ™‚æ‰è¨ˆç®—
watch(
  () => router.currentRoute.value,
  computeRecentRoutes
)
```

**æœ€ä½³åŒ–æˆæœ**:
- åˆå§‹åŒ–æ™‚é–“: **3 ç§’ â†’ 500ms** (83% æ”¹å–„)
- é¦–é  FCP: **4.2 ç§’ â†’ 1.8 ç§’** (57% æ”¹å–„)
- è¨˜æ†¶é«”ä½¿ç”¨: **é™ä½ 40%** (å¿«å–æ©Ÿåˆ¶)
-ä½¿ç”¨è€…é«”é©—: æ˜é¡¯æ”¹å–„é é¢éŸ¿æ‡‰é€Ÿåº¦

**ç›¸é—œæ–‡ä»¶**: [Router Session æ•ˆèƒ½æœ€ä½³åŒ–è©³è§£](./docs/04-guides/dev-notes/ROUTER_SESSION_PERFORMANCE_OPTIMIZATION.md)

---

### æŒ‘æˆ° 3: ServiceFactory ä¾è³´æ³¨å…¥æ¶æ§‹è¨­è¨ˆ

**è¨­è¨ˆç›®æ¨™**:
å»ºç«‹ä¸€å€‹é¬†è€¦åˆã€å¯æ¸¬è©¦ã€æ”¯æ´å¤šç’°å¢ƒè¨­å®šçš„ API æœå‹™å±¤æ¶æ§‹ã€‚

**æ¶æ§‹æŒ‘æˆ°**:
1. å¦‚ä½•é¿å…ç›´æ¥ä¾è³´ Supabase å¯¦ä¾‹ï¼Ÿ
2. å¦‚ä½•æ”¯æ´å–®å…ƒæ¸¬è©¦çš„ Mock æ³¨å…¥ï¼Ÿ
3. å¦‚ä½•ç®¡ç†æœå‹™å¯¦ä¾‹ç”Ÿå‘½é€±æœŸï¼Ÿ
4. å¦‚ä½•ç¢ºä¿é¡å‹å®‰å…¨ï¼Ÿ

**è§£æ±ºæ–¹æ¡ˆ** - ServiceFactory Pattern:

**æ ¸å¿ƒè¨­è¨ˆ**:
1. **ä¾è³´æ³¨å…¥** - é€éå»ºæ§‹å­æ³¨å…¥ SupabaseClientï¼Œè€Œéç›´æ¥å°å…¥å…¨åŸŸå¯¦ä¾‹
2. **å–®ä¾‹ç®¡ç†** - ä½¿ç”¨ Map å¿«å–æœå‹™å¯¦ä¾‹ï¼Œé¿å…é‡è¤‡å»ºç«‹
3. **é¡å‹å®‰å…¨** - ä½¿ç”¨ `import type` ç­–ç•¥ï¼Œç¢ºä¿ç„¡åŸ·è¡Œæ™‚ä¾è³´
4. **ç’°å¢ƒéš”é›¢** - æ”¯æ´é–‹ç™¼/æ¸¬è©¦/ç”Ÿç”¢ç’°å¢ƒç¨ç«‹è¨­å®š
5. **Mock æ³¨å…¥** - æ¸¬è©¦æ™‚å¯è¼•é¬†æ³¨å…¥ Mock Supabase Client

**æ¶æ§‹æµç¨‹**:
```
@/lib/supabase.ts (è¨­å®šå¯¦ä¾‹)
  â†“
services/index.ts (å»ºç«‹ defaultServiceFactory)
  â†“
ServiceFactory (ç®¡ç† 8 å€‹æœå‹™å¯¦ä¾‹)
  â†“
UserService / OrderService / NotificationService ...
```

**è¨­è¨ˆå„ªå‹¢**:
- âœ… é¬†è€¦åˆæ¶æ§‹ï¼Œæœå‹™å±¤èˆ‡å¯¦ä¾‹åŒ–é‚è¼¯åˆ†é›¢
- âœ… å¯æ¸¬è©¦æ€§é«˜ï¼Œè¼•é¬†æ³¨å…¥ Mock é€²è¡Œå–®å…ƒæ¸¬è©¦
- âœ… ç’°å¢ƒå½ˆæ€§ï¼Œæ”¯æ´å¤šç’°å¢ƒè¨­å®šåˆ‡æ›
- âœ… é¡å‹å®‰å…¨ï¼Œé¿å…åŸ·è¡Œæ™‚ä¾è³´å•é¡Œ

**æŸ¥çœ‹å®Œæ•´å¯¦ä½œ**: `admin-platform-vue/src/api/services/ServiceFactory.ts`
**ç›¸é—œæ–‡ä»¶**: [ServiceFactory æ¶æ§‹è¨­è¨ˆè©³è§£](./docs/04-guides/dev-notes/SERVICE_FACTORY_ARCHITECTURE.md)

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„

### 1. ServiceFactory ä¾è³´æ³¨å…¥æ¶æ§‹

ä¼æ¥­ç´š API æœå‹™å±¤è¨­è¨ˆï¼Œå¯¦ä½œé¬†è€¦åˆã€å¯æ¸¬è©¦ã€ç’°å¢ƒéš”é›¢çš„æœå‹™ç®¡ç†ã€‚

**æ ¸å¿ƒç‰¹æ€§**:
- ä¾è³´æ³¨å…¥æ¨¡å¼é¿å…ç›´æ¥è€¦åˆ Supabase å¯¦ä¾‹
- å–®ä¾‹æ¨¡å¼çµ±ä¸€ç®¡ç†æœå‹™å¯¦ä¾‹ç”Ÿå‘½é€±æœŸ
- `import type` ç­–ç•¥ç¢ºä¿é¡å‹å®‰å…¨ä¸”ç„¡åŸ·è¡Œæ™‚ä¾è³´
- æ”¯æ´å¤šç’°å¢ƒè¨­å®šï¼ˆé–‹ç™¼/æ¸¬è©¦/ç”Ÿç”¢ï¼‰
- å®Œæ•´çš„å–®å…ƒæ¸¬è©¦æ”¯æ´ï¼ˆMock æ³¨å…¥ï¼‰

**æ¶æ§‹å±¤ç´š**:
```
ServiceFactory
  â”œâ”€â”€ UserApiService (ç”¨æˆ¶ç®¡ç†)
  â”œâ”€â”€ OrderApiService (è¨‚å–®ç®¡ç†)
  â”œâ”€â”€ ProductApiService (ç”¢å“ç®¡ç†)
  â”œâ”€â”€ CustomerApiService (å®¢æˆ¶ç®¡ç†)
  â”œâ”€â”€ NotificationApiService (é€šçŸ¥ç®¡ç†)
  â”œâ”€â”€ CampaignApiService (æ´»å‹•åˆ†æ)
  â”œâ”€â”€ SupportTicketApiService (å·¥å–®ç³»çµ±)
  â””â”€â”€ DashboardApiService (å„€è¡¨æ¿)
```

**è©³ç´°èªªæ˜**: åƒè€ƒã€Œè§£æ±ºçš„æŠ€è¡“æŒ‘æˆ° â†’ æŒ‘æˆ° 3ã€ç« ç¯€å®Œæ•´å±•ç¤º

---

### 2. æ™ºèƒ½é€šçŸ¥ç³»çµ±

åŸºæ–¼ PostgreSQL è§¸ç™¼å™¨å’Œ Supabase Realtime çš„ä¼æ¥­ç´šé€šçŸ¥è§£æ±ºæ–¹æ¡ˆã€‚

**ç³»çµ±æ¶æ§‹**:
- **å¾Œç«¯å±¤**: PostgreSQL è§¸ç™¼å™¨è‡ªå‹•æ•ç²æ¥­å‹™äº‹ä»¶
- **é‚è¼¯å±¤**: æ™ºèƒ½å»ºè­°å‡½æ•¸åˆ¤æ–·é€šçŸ¥å®Œæˆæ™‚æ©Ÿ
- **å‚³è¼¸å±¤**: Supabase Realtime å³æ™‚æ¨é€
- **å‰ç«¯å±¤**: Vue 3 Composition API éŸ¿æ‡‰å¼æ›´æ–°

**æ ¸å¿ƒåŠŸèƒ½**:
- è‡ªå‹•é€šçŸ¥è§¸ç™¼ï¼ˆè¨‚å–®ã€ç”¢å“ã€å®¢æˆ¶ã€åº«å­˜ï¼‰
- æ™ºèƒ½å®Œæˆå»ºè­°ç³»çµ±ï¼ˆåŸºæ–¼æ¥­å‹™é‚è¼¯åˆ¤æ–·ï¼‰
- è§’è‰²ç¾¤çµ„è·¯ç”±ï¼ˆä¸åŒè§’è‰²çœ‹åˆ°ä¸åŒé€šçŸ¥ï¼‰
- ç³»çµ±æ¨¡æ¿ä¿è­·æ©Ÿåˆ¶ï¼ˆ8 å€‹æ ¸å¿ƒæ¨¡æ¿å¤šå±¤ä¿è­·ï¼‰
- é€šçŸ¥æ¨¡æ¿ç®¡ç†ï¼ˆæ”¯æ´è®Šæ•¸æ’å€¼ï¼‰

**æŠ€è¡“ç‰¹è‰²**:
- PostgreSQL è§¸ç™¼å™¨è‡ªå‹•æ•ç²æ¥­å‹™äº‹ä»¶
- æ™ºèƒ½å»ºè­°å‡½æ•¸åˆ¤æ–·é€šçŸ¥å®Œæˆæ™‚æ©Ÿ
- Supabase Realtime å³æ™‚æ¨é€
- Vue 3 Composition API éŸ¿æ‡‰å¼æ›´æ–°

**è©³ç´°èªªæ˜**: åƒè€ƒã€Œè§£æ±ºçš„æŠ€è¡“æŒ‘æˆ° â†’ æŒ‘æˆ° 1ã€ç« ç¯€å®Œæ•´å±•ç¤º
**ç›¸é—œæ–‡ä»¶**: [é€šçŸ¥ç³»çµ±æ¦‚è¿°](./docs/04-guides/dev-notes/NOTIFICATION_SYSTEM_OVERVIEW.md)

---

### 3. æ´»å‹•åˆ†å±¤æ­¸å› åˆ†æ

å¤šè§¸é»æ­¸å› æ¬Šé‡è¨ˆç®—ç³»çµ±ï¼Œæ”¯æ´ä¸‰å±¤æ­¸å› åˆ†é¡å’Œå”ä½œåˆ†æã€‚

**åˆ†æç¶­åº¦**:
1. **ç¸½è¦½åˆ†æ** - æ´»å‹•æ•ˆæœçµ±è¨ˆèˆ‡åˆ†å±¤æ•ˆæœ
2. **æ­¸å› åˆ†æ** - å¤šç¶­åº¦æ­¸å› æ¬Šé‡åˆ†æ
3. **å”ä½œåˆ†æ** - æ´»å‹•é–“å”ä½œæ•ˆæœè©•ä¼°
4. **é‡ç–Šåˆ†æ** - æ´»å‹•æœŸé–“é‡ç–Šæƒ…æ³èˆ‡ç«¶çˆ­å¼·åº¦
5. **è¶¨å‹¢åˆ†æ** - æ´»å‹•æ•ˆæœè¶¨å‹¢èˆ‡ç¸¾æ•ˆè©•ä¼°
6. **è¦å‰‡ç®¡ç†** - æ­¸å› è¦å‰‡è¨­å®šèˆ‡ç®¡ç†

**æ­¸å› é‚è¼¯**ï¼ˆæ ¸å¿ƒæ¦‚å¿µï¼‰:

1. **æ´»å‹•åˆ†å±¤åˆ†é¡**
   - site-wideï¼ˆå…¨ç«™æ´»å‹•ï¼‰ï¼šseasonalã€holidayã€flash_sale
   - target-orientedï¼ˆç›®æ¨™å°å‘ï¼‰ï¼šmembershipã€demographic
   - category-specificï¼ˆé¡åˆ¥å°ˆå±¬ï¼‰ï¼šcategoryã€product_launch

2. **æ¬Šé‡æ­£è¦åŒ–è¨ˆç®—**
   - å±¤ç´šå…§æ¬Šé‡æ­£è¦åŒ–ï¼š`normalized_weight = raw_weight / SUM(raw_weight) OVER (PARTITION BY attribution_layer)`
   - ç¢ºä¿åŒå±¤æ´»å‹•æ¬Šé‡ç¸½å’Œç‚º 1

3. **ç‡Ÿæ”¶æ­¸å› åˆ†é…**
   - æŒ‰æ­£è¦åŒ–æ¬Šé‡åˆ†é…ç‡Ÿæ”¶ï¼š`attributed_revenue = total_amount * normalized_weight`
   - æ”¯æ´å¤šè§¸é»æ­¸å› åˆ†æ

**æŠ€è¡“å¯¦ä½œ**:
- PostgreSQL è¦–åœ–å°è£è¤‡é›œ JOIN é‚è¼¯
- CampaignApiService æä¾›çµ±ä¸€æŸ¥è©¢ä»‹é¢
- Vue Query å¯¦ä½œæ™ºèƒ½å¿«å–ç­–ç•¥
- Unovis åœ–è¡¨åº«è¦–è¦ºåŒ–å‘ˆç¾

**æŸ¥çœ‹å®Œæ•´å¯¦ä½œ**: `supabase/migrations/20250723200000_layered_attribution_implementation.sql`
**ç›¸é—œæ–‡ä»¶**: [æ´»å‹•åˆ†æç³»çµ±æ¶æ§‹](./docs/02-development/architecture/campaign-system.md)

---

### 4. å®¢æˆ¶ RFM åˆ†ç¾¤åˆ†æ

åŸºæ–¼ Recencyã€Frequencyã€Monetary æ¨¡å‹çš„å®¢æˆ¶åƒ¹å€¼è©•ä¼°ç³»çµ±ã€‚

**RFM æ¨¡å‹**:
- **Recency (æœ€è¿‘è³¼è²·)** - æœ€å¾Œä¸€æ¬¡è³¼è²·è·ä»Šå¤©æ•¸
- **Frequency (è³¼è²·é »ç‡)** - æ­·å²è³¼è²·æ¬¡æ•¸
- **Monetary (è³¼è²·é‡‘é¡)** - ç´¯è¨ˆæ¶ˆè²»é‡‘é¡

**å®¢æˆ¶åˆ†ç¾¤**:
- ğŸ’ VIP å®¢æˆ¶ - R: é«˜, F: é«˜, M: é«˜
- â­ å¿ èª å®¢æˆ¶ - R: ä¸­, F: é«˜, M: ä¸­
- ğŸ¯ æ½›åŠ›å®¢æˆ¶ - R: é«˜, F: ä½, M: ä¸­
- âš ï¸ æµå¤±é¢¨éšª - R: ä½, F: ä½, M: ä½

**åˆ†æåŠŸèƒ½**:
- RFM åˆ†ç¾¤æ¨™ç±¤è¦–è¦ºåŒ–
- å®¢æˆ¶è¡Œç‚ºè¿½è¹¤åœ–è¡¨
- æµå¤±é¢¨éšªé è­¦ç³»çµ±
- å®¢æˆ¶åƒ¹å€¼æ•£é»åœ–

**è¨ˆç®—é‚è¼¯**ï¼ˆæ ¸å¿ƒæ¦‚å¿µï¼‰:
- **Recency è©•åˆ†**: æœ€å¾Œè³¼è²·è·ä»Šå¤©æ•¸ â†’ è©•åˆ† 0-10ï¼ˆè¶Šè¿‘è¶Šé«˜ï¼‰
- **Frequency è©•åˆ†**: æ­·å²è³¼è²·æ¬¡æ•¸ â†’ è©•åˆ† 0-10ï¼ˆè¶Šå¤šè¶Šé«˜ï¼‰
- **Monetary è©•åˆ†**: ç´¯è¨ˆæ¶ˆè²»é‡‘é¡ â†’ è©•åˆ† 0-10ï¼ˆè¶Šé«˜è¶Šé«˜ï¼‰
- **åˆ†ç¾¤åˆ†é¡**: åŸºæ–¼ RFM ä¸‰ç¶­åº¦åˆ†æ•¸çµ„åˆï¼Œè‡ªå‹•åˆ†é¡ç‚º VIP/å¿ èª /æ½›åŠ›/æµå¤±é¢¨éšª

---

### 5. å³æ™‚è³‡æ–™è¨‚é–±ç³»çµ±

åŸºæ–¼ Supabase Realtime çš„å¤šæ¨¡çµ„å³æ™‚æ›´æ–°æ¶æ§‹ã€‚

**ç›£æ§æ¨¡çµ„**:
- **Notifications** - å³æ™‚é€šçŸ¥æ¨é€ï¼ˆæ¬Šé‡ 1.5ï¼‰
- **Orders** - è¨‚å–®ç‹€æ…‹æ›´æ–°ï¼ˆæ¬Šé‡ 2.0ï¼Œæœ€é«˜å„ªå…ˆï¼‰
- **Inventory** - åº«å­˜æ•¸é‡è®Šå‹•ï¼ˆæ¬Šé‡ 1.2ï¼‰

**éŒ¯èª¤è¿½è¹¤èˆ‡è­¦å ±**:
- 5 åˆ†é˜å…§è¶…é 3 æ¬¡éŒ¯èª¤è‡ªå‹•è§¸ç™¼è­¦å ±
- æ ¹æ“šéŒ¯èª¤é »ç‡èª¿æ•´åš´é‡ç¨‹åº¦ï¼ˆlow/medium/high/criticalï¼‰
- çµ±ä¸€çš„ `useRealtimeAlerts` composable ç®¡ç†è·¨æ¨¡çµ„è­¦å ±

**ç³»çµ±ç©©å®šåº¦è¨ˆç®—**:
- åŸºæ–¼å¤šæ¨¡çµ„æ¬Šé‡è¨ˆç®—ç³»çµ±å¥åº·åº¦ï¼ˆ0-10 åˆ†ï¼‰
- è¨‚å–®ç³»çµ±æ¬Šé‡æœ€é«˜ï¼ˆ2.0ï¼‰ï¼Œé€šçŸ¥æ¬¡ä¹‹ï¼ˆ1.5ï¼‰ï¼Œåº«å­˜é©ä¸­ï¼ˆ1.2ï¼‰
- æ•´åˆè‡³æ¥­å‹™å¥åº·åº¦é›·é”åœ–ä½œç‚ºç¬¬ 7 ç¶­åº¦

**æŠ€è¡“å„ªå‹¢**:
- çµ±ä¸€çš„éŒ¯èª¤è¿½è¹¤æ©Ÿåˆ¶
- æ™‚é–“çª—å£éæ¿¾ï¼ˆ5 åˆ†é˜å…§éŒ¯èª¤è¨ˆæ•¸ï¼‰
- æ¬Šé‡åˆ†ç´šç³»çµ±ï¼ˆè¨‚å–® > é€šçŸ¥ > åº«å­˜ï¼‰
- è‡ªå‹•å‚™æ´æ¨¡å¼ï¼ˆé€£ç·šå¤±æ•—æ™‚å•Ÿå‹•è¼ªè©¢ï¼‰

---

## ğŸ—„ï¸ è³‡æ–™åº«èˆ‡å¾Œç«¯

### è³‡æ–™åº«è¨­è¨ˆäº®é»

**æŠ€è¡“æˆæœ**:
- **195 å€‹ Migration æª”æ¡ˆ** - å®Œæ•´çš„è³‡æ–™åº«æ¼”é€²è¿½è¹¤
- **14 å€‹ Edge Functions** - ä¼ºæœå™¨ç«¯å•†æ¥­é‚è¼¯ä¿è­·
- **RLS å®‰å…¨ç­–ç•¥** - è¡Œç´šæ¬Šé™æ§åˆ¶
- **PostgreSQL è§¸ç™¼å™¨** - è‡ªå‹•åŒ–æ¥­å‹™æµç¨‹

### ä»£è¡¨æ€§å¯¦ä½œ

#### 1. æ´»å‹•åˆ†å±¤æ­¸å› åˆ†æè¦–åœ–

**æª”æ¡ˆ**: `supabase/migrations/20250723200000_layered_attribution_implementation.sql`

**åŠŸèƒ½**:
- å¤šè§¸é»æ­¸å› æ¬Šé‡è¨ˆç®—
- ä¸‰å±¤æ­¸å› åˆ†é¡ï¼ˆsite-wide/target-oriented/category-specificï¼‰
- è¤‡é›œ JOIN é‚è¼¯å°è£ç‚ºè¦–åœ–

**æŠ€è¡“äº®é»**: è©³è¦‹ã€Œæ ¸å¿ƒåŠŸèƒ½æ¨¡çµ„ â†’ 3. æ´»å‹•åˆ†å±¤æ­¸å› åˆ†æã€ç« ç¯€ï¼ˆLines 300-362ï¼‰å®Œæ•´å±•ç¤º

---

#### 2. é€šçŸ¥ç³»çµ± PostgreSQL è§¸ç™¼å™¨

**æª”æ¡ˆ**: `supabase/migrations/20250731170000_fix_notification_triggers_for_real_tables.sql`

**åŠŸèƒ½**:
- è¨‚å–®ç‹€æ…‹è®Šæ›´è‡ªå‹•è§¸ç™¼é€šçŸ¥
- æ™ºèƒ½å»ºè­°é‚è¼¯æ•´åˆ
- 8 å€‹ç³»çµ±æ¨¡æ¿å¤šå±¤ä¿è­·æ©Ÿåˆ¶

**è§¸ç™¼å™¨ç¯„ä¾‹**: è©³è¦‹ã€Œè§£æ±ºçš„æŠ€è¡“æŒ‘æˆ° â†’ æŒ‘æˆ° 1ã€ç« ç¯€ï¼ˆLines 190-227ï¼‰å®Œæ•´å±•ç¤º

---

#### 3. RLS å®‰å…¨ç­–ç•¥è¨­è¨ˆ

**æª”æ¡ˆ**: `supabase/migrations/20251002300000_add_rls_to_analytics_tables.sql`

**åŠŸèƒ½**:
- åˆ†æè³‡æ–™è¡¨çš„è¡Œç´šæ¬Šé™æ§åˆ¶
- SECURITY DEFINER å‡½æ•¸æœ€ä½³åŒ–æ•ˆèƒ½
- ç”¨æˆ¶éš±ç§ä¿è­·æ©Ÿåˆ¶

**RLS ç¯„ä¾‹**:
```sql
-- å•Ÿç”¨ RLS
ALTER TABLE campaign_effectiveness_metrics ENABLE ROW LEVEL SECURITY;

-- ç®¡ç†å“¡å¯æŸ¥çœ‹æ‰€æœ‰è³‡æ–™
CREATE POLICY "Admins can view all campaigns"
ON campaign_effectiveness_metrics FOR SELECT
USING (
  EXISTS (
    SELECT 1 FROM user_roles
    WHERE user_roles.user_id = auth.uid()
    AND user_roles.role_name = 'admin'
  )
);

-- æ¥­å‹™ç¶“ç†åªèƒ½æŸ¥çœ‹è‡ªå·±è² è²¬çš„æ´»å‹•
CREATE POLICY "Managers can view own campaigns"
ON campaign_effectiveness_metrics FOR SELECT
USING (
  EXISTS (
    SELECT 1 FROM campaign_managers
    WHERE campaign_managers.campaign_id = campaign_effectiveness_metrics.id
    AND campaign_managers.user_id = auth.uid()
  )
);
```

---

### Edge Functions - æ¥­å‹™å¥åº·åº¦è¨ˆç®—å¼•æ“

**æª”æ¡ˆ**: `supabase/functions/business-health-analytics/index.ts`

**åŠŸèƒ½æ¦‚è¿°**: 850 è¡Œ TypeScript å¯¦ä½œ 7 ç¶­åº¦æ¥­å‹™å¥åº·åº¦è©•åˆ†ç³»çµ±

**æ ¸å¿ƒç®—æ³•æ¡†æ¶**:

```typescript
// æ¥­å‹™å¥åº·åº¦æŒ‡æ¨™å®šç¾©
interface BusinessHealthMetrics {
  revenue: number          // ç‡Ÿæ”¶å¥åº·åº¦ (0-10)
  satisfaction: number     // å®¢æˆ¶æ»¿æ„åº¦ (0-10)
  fulfillment: number      // å±¥è¡Œå¥åº·åº¦ (0-10)
  support: number          // æ”¯æ´å¥åº·åº¦ (0-10)
  products: number         // ç”¢å“å¥åº·åº¦ (0-10)
  marketing: number        // è¡ŒéŠ·å¥åº·åº¦ (0-10)
  system: number           // ç³»çµ±ç©©å®šåº¦ (0-10)
}

// æ ¸å¿ƒè¨ˆç®—å¼•æ“ï¼ˆä¼ºæœå™¨ç«¯ä¿è­·å•†æ¥­é‚è¼¯ï¼‰
async function calculateBusinessHealthMetrics(
  supabase: SupabaseClient,
  period: '7d' | '30d' | '90d'
): Promise<BusinessHealthMetrics> {
  // ğŸ” 7 å€‹æ ¸å¿ƒè©•åˆ†ç®—æ³•åœ¨æ­¤å¯¦ä½œ
  // é¿å…å‰ç«¯æš´éœ²å•†æ¥­è¦å‰‡

  const revenue = await calculateRevenueHealth(supabase, period)
  const satisfaction = await calculateSatisfactionHealth(supabase, period)
  // ... å…¶ä»–ç¶­åº¦è¨ˆç®—

  return { revenue, satisfaction, fulfillment, support, products, marketing, system }
}
```

**æŠ€è¡“å„ªå‹¢**:
-å•†æ¥­é‚è¼¯ä¼ºæœå™¨ç«¯ä¿è­·
-å¤§é‡è³‡æ–™æŸ¥è©¢åœ¨è³‡æ–™åº«ç«¯å®Œæˆ
-Service Role Key å­˜å–æ•æ„Ÿè³‡æ–™
-æ”¯æ´å¤šæ™‚é–“é€±æœŸåˆ†æï¼ˆ7 å¤©/30 å¤©/90 å¤©ï¼‰

**æŸ¥çœ‹å®Œæ•´å¯¦ä½œ**: [supabase/functions/business-health-analytics/](./supabase/functions/business-health-analytics/)

---

## ğŸ› ï¸ é–‹ç™¼ç’°å¢ƒèˆ‡å·¥å…·éˆ

> **ğŸ“Œ èªªæ˜**ï¼šæ­¤ç‚ºå±•ç¤ºå°ˆæ¡ˆï¼Œä»¥ä¸‹å…§å®¹å±•ç¤ºå®Œæ•´ç³»çµ±çš„é–‹ç™¼å·¥å…·éˆè¨­è¨ˆèˆ‡å·¥ä½œæµç¨‹ã€‚

### å·¥å…·éˆæ¶æ§‹

**å‰ç«¯å·¥å…·éˆ**:
- **Vite** - é–‹ç™¼ä¼ºæœå™¨èˆ‡ç”Ÿç”¢å»ºç½®
- **TypeScript** - åš´æ ¼æ¨¡å¼é¡å‹æª¢æŸ¥
- **Vitest** - æ¸¬è©¦å¥—ä»¶ (471 æ¸¬è©¦å…¨éƒ¨é€šé)
- **ESLint** - ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥
- **Husky** - Git pre-commit hooks

**å¾Œç«¯å·¥å…·éˆ**:
- **Docker Desktop** - å®¹å™¨åŒ–é–‹ç™¼ç’°å¢ƒ
- **Supabase CLI** - è³‡æ–™åº«ç®¡ç†èˆ‡ Migration
- **PostgreSQL** - è³‡æ–™åº«å¼•æ“
- **Edge Functions** - ç„¡ä¼ºæœå™¨å‡½æ•¸åŸ·è¡Œç’°å¢ƒ

### é–‹ç™¼æµç¨‹è¨­è¨ˆ

```
æœ¬åœ°é–‹ç™¼
  â†“ Supabase CLI (Migration ç®¡ç†)
ç‰ˆæœ¬æ§åˆ¶
  â†“ Git commit + Husky hooks
è‡ªå‹•åŒ–æ¸¬è©¦
  â†“ Vitest (471 æ¸¬è©¦å…¨éƒ¨é€šé)
é¡å‹æª¢æŸ¥
  â†“ TypeScript strict mode
ç”Ÿç”¢å»ºç½®
  â†“ Vite build + å„ªåŒ–
```

### DevOps è‡ªå‹•åŒ–

- **å¥åº·æª¢æŸ¥**: `scripts/health-check.sh` (167 è¡Œ) - Docker ç’°å¢ƒé©—è­‰ã€æœå‹™ç‹€æ…‹æª¢æ¸¬
- **ç’°å¢ƒç®¡ç†**: `scripts/prod.sh` (175 è¡Œ) - ä¸€éµå•Ÿå‹•/åœæ­¢/é‡å•Ÿæœå‹™
- **CI/CD æ•´åˆ**: Husky pre-commit hooks - è‡ªå‹•åŒ–æ¸¬è©¦èˆ‡ç¨‹å¼ç¢¼å“è³ªæª¢æŸ¥

**ç›¸é—œç« ç¯€**: è©³è¦‹ã€ŒğŸ”§ DevOps è‡ªå‹•åŒ–å·¥å…·ã€ç« ç¯€å®Œæ•´å±•ç¤º

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
ecommerce-admin-platform/
â”œâ”€â”€ admin-platform-vue/           # å‰ç«¯å°ˆæ¡ˆï¼ˆVue 3 + TypeScriptï¼‰
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/                  # API æœå‹™å±¤ï¼ˆServiceFactoryï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ services/         # 8 å€‹æ¥­å‹™æœå‹™é¡
â”‚   â”‚   â”œâ”€â”€ components/           # çµ„ä»¶åº«ï¼ˆå±•ç¤ºæ ¸å¿ƒæ¶æ§‹ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ data-table-*/     # è³‡æ–™è¡¨æ ¼ç³»çµ±ï¼ˆ3 å±¤æ¶æ§‹ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ charts/           # Unovis åœ–è¡¨çµ„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ notify/           # é€šçŸ¥ç³»çµ±çµ„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ ui/               # Radix Vue åŸºç¤çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ composables/          # çµ„åˆå¼å‡½æ•¸ï¼ˆæ¥­å‹™é‚è¼¯æŠ½è±¡ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ data-table-actions/  # è¡¨æ ¼æ“ä½œé‚è¼¯
â”‚   â”‚   â”‚   â”œâ”€â”€ queries/          # Vue Query æŸ¥è©¢
â”‚   â”‚   â”‚   â””â”€â”€ analytics/        # åˆ†æåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ views/                # é é¢çµ„ä»¶ï¼ˆæ ¸å¿ƒæ¥­å‹™å ´æ™¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ store/                # Pinia ç‹€æ…‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ router/               # Vue Router è¨­å®š
â”‚   â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•¸
â”‚   â”‚   â””â”€â”€ types/                # TypeScript é¡å‹å®šç¾©
â”‚   â”œâ”€â”€ tests/                    # æ¸¬è©¦æª”æ¡ˆï¼ˆ471 æ¸¬è©¦å…¨éƒ¨é€šéï¼‰
â”‚   â””â”€â”€ docs/                     # å‰ç«¯å°ˆå±¬æ–‡ä»¶
â”œâ”€â”€ supabase/                     # å¾Œç«¯å°ˆæ¡ˆï¼ˆSupabaseï¼‰
â”‚   â”œâ”€â”€ migrations/               # è³‡æ–™åº«é·ç§»æª”æ¡ˆï¼ˆ195 å€‹ï¼‰
â”‚   â”œâ”€â”€ functions/                # Edge Functionsï¼ˆ14 å€‹ï¼‰
â”‚   â”‚   â”œâ”€â”€ business-health-analytics/  # æ¥­å‹™å¥åº·åº¦è¨ˆç®—
â”‚   â”‚   â”œâ”€â”€ campaign-scoring/           # æ´»å‹•è©•åˆ†ç®—æ³•
â”‚   â”‚   â””â”€â”€ customer-segmentation/      # RFM å®¢æˆ¶åˆ†ç¾¤
â”‚   â”œâ”€â”€ seed-core.sql             # æ ¸å¿ƒç¨®å­è³‡æ–™
â”‚   â””â”€â”€ docs/                     # å¾Œç«¯å°ˆå±¬æ–‡ä»¶
â”œâ”€â”€ scripts/                      # è‡ªå‹•åŒ–è…³æœ¬
â”‚   â”œâ”€â”€ health-check.sh           # ç³»çµ±å¥åº·æª¢æŸ¥
â”‚   â””â”€â”€ prod.sh                   # ç”Ÿç”¢ç’°å¢ƒç®¡ç†
â”œâ”€â”€ docs/                         # å…¨å°ˆæ¡ˆæŠ€è¡“æ–‡ä»¶
â”‚   â”œâ”€â”€ 01-planning/              # è¦åŠƒéšæ®µæ–‡ä»¶
â”‚   â”œâ”€â”€ 02-development/           # é–‹ç™¼éšæ®µæ–‡ä»¶
â”‚   â”œâ”€â”€ 03-deployment/            # éƒ¨ç½²ç›¸é—œæ–‡ä»¶
â”‚   â”œâ”€â”€ 04-guides/                # æŒ‡å—èˆ‡æ•™ç¨‹
â”‚   â””â”€â”€ 05-reference/             # åƒè€ƒè³‡æ–™
â””â”€â”€ README.md                     # æœ¬æ–‡ä»¶
```

---

## ğŸ”§ DevOps è‡ªå‹•åŒ–å·¥å…·

### 1. ç³»çµ±å¥åº·æª¢æŸ¥å·¥å…·

**æª”æ¡ˆ**: `scripts/health-check.sh`ï¼ˆ167 è¡Œï¼‰

**åŠŸèƒ½**:
- è‡ªå‹•æª¢æ¸¬ Docker ç’°å¢ƒ
- Supabase æœå‹™ç‹€æ…‹é©—è­‰
- è³‡æ–™åº«é€£ç·šæ¸¬è©¦
- Realtime è¨‚é–±æ¸¬è©¦
- å½©è‰²è¼¸å‡ºèˆ‡è¨ºæ–·æç¤º

**ä½¿ç”¨ç¯„ä¾‹**:
```bash
./scripts/health-check.sh

# è¼¸å‡ºç¯„ä¾‹
ç³»çµ±å¥åº·æª¢æŸ¥é–‹å§‹...
Docker ç’°å¢ƒæ­£å¸¸
Supabase æœå‹™é‹è¡Œä¸­ï¼ˆ5/5 å®¹å™¨å¥åº·ï¼‰
PostgreSQL é€£ç·šæ­£å¸¸ï¼ˆå»¶é²: 12msï¼‰
Realtime è¨‚é–±æ­£å¸¸
ç³»çµ±å¥åº·æª¢æŸ¥é€šéï¼
```

---

### 2. ç”Ÿç”¢ç’°å¢ƒç®¡ç†å·¥å…·

**æª”æ¡ˆ**: `scripts/prod.sh`ï¼ˆ175 è¡Œï¼‰

**åŠŸèƒ½**:
- ä¸€éµå•Ÿå‹•/åœæ­¢/é‡å•Ÿæœå‹™
- Docker Compose æ•´åˆ
- ç’°å¢ƒè®Šæ•¸é©—è­‰
- æ—¥èªŒæŸ¥çœ‹èˆ‡é™¤éŒ¯
- å…§å»ºå¥åº·æª¢æŸ¥æ•´åˆ

**ä½¿ç”¨ç¯„ä¾‹**:
```bash
# å•Ÿå‹•ç”Ÿç”¢ç’°å¢ƒ
./scripts/prod.sh start

# é‡æ–°å»ºç½®ä¸¦å•Ÿå‹•
./scripts/prod.sh rebuild

# æŸ¥çœ‹æœå‹™æ—¥èªŒ
./scripts/prod.sh logs

# ç³»çµ±å¥åº·æª¢æŸ¥
./scripts/prod.sh health
```

---

### 3. Supabase CLI å·¥ä½œæµç¨‹

**æœ¬åœ°é–‹ç™¼ç’°å¢ƒç®¡ç†**:

```bash
# 1. å•Ÿå‹•å®Œæ•´ Supabase æœ¬åœ°ç’°å¢ƒ
supabase start
# å•Ÿå‹•æœå‹™: PostgreSQL, Auth, Storage, Realtime, Edge Functions

# 2. è³‡æ–™åº«é‡ç½®èˆ‡ç¨®å­è³‡æ–™è¼‰å…¥
supabase db reset
# åŸ·è¡Œæ‰€æœ‰ migrations + seed-core.sql

# 3. Migration ç®¡ç†
supabase migration new add_feature_x
supabase db diff > migrations/new_changes.sql

# 4. éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ
supabase db push --db-url="postgresql://..."
```

**DevOps æµç¨‹è¨­è¨ˆ**:

```
æœ¬åœ°é–‹ç™¼
  â†“ Supabase CLI
é–‹ç™¼æ¸¬è©¦
  â†“ migration ç®¡ç†
ç‰ˆæœ¬æ§åˆ¶
  â†“ Git commit
CI/CD è§¸ç™¼
  â†“ è‡ªå‹•åŒ–æ¸¬è©¦
ç”Ÿç”¢éƒ¨ç½²
  â†“ health-check.sh é©—è­‰
ç›£æ§å‘Šè­¦
```

---

### 4. è‡ªå‹•åŒ–å·¥å…·ç¸½çµ

| å·¥å…· | åŠŸèƒ½ | è¡Œæ•¸ | æŠ€è¡“äº®é» |
|------|------|------|----------|
| **health-check.sh** | ç³»çµ±å¥åº·æª¢æŸ¥ | 167 è¡Œ | ç’°å¢ƒå€åˆ†ã€å½©è‰²è¼¸å‡ºã€è¨ºæ–·æç¤º |
| **prod.sh** | ç”Ÿç”¢ç’°å¢ƒç®¡ç† | 175 è¡Œ | éŒ¯èª¤è™•ç†ã€è‡ªå‹•åŒ–éƒ¨ç½²ã€å¥åº·æª¢æŸ¥ |
| **Supabase CLI** | è³‡æ–™åº«ç®¡ç† | - | Migration ç®¡ç†ã€æœ¬åœ°é–‹ç™¼ç’°å¢ƒ |

**DevOps èƒ½åŠ›å±•ç¤º**:

- **è‡ªå‹•åŒ–æ€ç¶­** - Shell è…³æœ¬ç°¡åŒ–é‡è¤‡æ€§æ“ä½œ
- **ç’°å¢ƒéš”é›¢** - é–‹ç™¼/æ¸¬è©¦/ç”Ÿç”¢ç’°å¢ƒå®Œæ•´åˆ†é›¢
- **éŒ¯èª¤è™•ç†** - å®Œæ•´çš„ç•°å¸¸æ•ç²å’Œä½¿ç”¨è€…æç¤º
- **å¯ç¶­è­·æ€§** - æ¸…æ™°çš„è¨»è§£å’Œæ¨¡çµ„åŒ–è¨­è¨ˆ
- **ä½¿ç”¨è€…é«”é©—** - å½©è‰²è¼¸å‡ºå’Œå‹å¥½çš„è¨ºæ–·è³‡è¨Š

---

## ğŸ“š æ–‡ä»¶æ¶æ§‹

æœ¬å°ˆæ¡ˆæ¡ç”¨ **VitePress ä¸‰å±¤æ–‡ä»¶æ¶æ§‹**ï¼Œç¢ºä¿æ–‡ä»¶çµ„ç¹”æ¸…æ™°ã€æ˜“æ–¼ç¶­è­·ã€‚

### æ–‡ä»¶åˆ†å±¤ç­–ç•¥

```
docs/                              # å…¨å°ˆæ¡ˆæ–‡ä»¶ï¼ˆç³»çµ±æ¶æ§‹ã€API è¦æ ¼ï¼‰
â”œâ”€â”€ 01-planning/                   # è¦åŠƒéšæ®µæ–‡ä»¶
â”œâ”€â”€ 02-development/                # é–‹ç™¼éšæ®µæ–‡ä»¶
â”‚   â”œâ”€â”€ architecture/              # æ¶æ§‹è¨­è¨ˆæ–‡ä»¶
â”‚   â””â”€â”€ api/                       # API è¦æ ¼æ–‡ä»¶
â”œâ”€â”€ 03-deployment/                 # éƒ¨ç½²ç›¸é—œæ–‡ä»¶
â”œâ”€â”€ 04-guides/                     # æŒ‡å—èˆ‡æ•™ç¨‹
â”‚   â””â”€â”€ dev-notes/                 # é–‹ç™¼ç­†è¨˜
â””â”€â”€ 05-reference/                  # åƒè€ƒè³‡æ–™

admin-platform-vue/docs/           # å‰ç«¯å°ˆå±¬æ–‡ä»¶
â”œâ”€â”€ 01-getting-started/            # å‰ç«¯å¿«é€Ÿé–‹å§‹
â”œâ”€â”€ 02-components/                 # çµ„ä»¶åº«æ–‡ä»¶
â”œâ”€â”€ 03-composables/                # Composables ä½¿ç”¨æŒ‡å—
â””â”€â”€ 04-guides/                     # å‰ç«¯é–‹ç™¼æŒ‡å—

supabase/docs/                     # å¾Œç«¯å°ˆå±¬æ–‡ä»¶
â”œâ”€â”€ 01-getting-started/            # Supabase æœ¬åœ°é–‹ç™¼
â”œâ”€â”€ 02-database/                   # è³‡æ–™åº«è¨­è¨ˆæ–‡ä»¶
â”‚   â”œâ”€â”€ migrations/                # Migration ç®¡ç†ç­–ç•¥
â”‚   â””â”€â”€ triggers/                  # è§¸ç™¼å™¨æ–‡ä»¶
â””â”€â”€ 03-edge-functions/             # Edge Functions é–‹ç™¼æŒ‡å—
```

### æ ¸å¿ƒæ–‡ä»¶æ¸…å–®

| æ–‡ä»¶ | è·¯å¾‘ | èªªæ˜ |
|------|------|------|
| é€šçŸ¥ç³»çµ±æ¦‚è¿° | `docs/04-guides/dev-notes/` | é€šçŸ¥ç³»çµ±å®Œæ•´æ¶æ§‹èˆ‡å¿«é€Ÿé–‹å§‹ |
| ServiceFactory æ¶æ§‹ | `docs/04-guides/dev-notes/` | ä¾è³´æ³¨å…¥æ¨¡å¼è¨­è¨ˆè©³è§£ |
| æ´»å‹•åˆ†æç³»çµ± | `docs/02-development/architecture/` | åˆ†å±¤æ­¸å› æ©Ÿåˆ¶æ¶æ§‹æ–‡ä»¶ |
| Migration ç­–ç•¥ | `supabase/docs/02-database/migrations/` | è³‡æ–™åº«æ¼”é€²ç®¡ç†æœ€ä½³å¯¦è¸ |
| æœ¬åœ°é–‹ç™¼æŒ‡å— | `supabase/docs/01-getting-started/` | Supabase CLI å®Œæ•´ä½¿ç”¨æŒ‡å— |

**æ–‡ä»¶è¨­è¨ˆåŸå‰‡**:
- **ç¾æ³å„ªå…ˆ** - æ–‡ä»¶åæ˜ å¯¦éš›ç¨‹å¼ç¢¼å¯¦ä½œ
- **å–®ä¸€çœŸå¯¦ä¾†æº** - æ¯é¡è³‡è¨Šåªåœ¨ä¸€è™•ç¶­è­·
- **åˆ†å±¤å¼•ç”¨** - é«˜å±¤æ–‡ä»¶å¼•ç”¨ä½å±¤æ–‡ä»¶

---

## ğŸ“ å­¸ç¿’é‡é»

å¦‚æœæ‚¨æ˜¯é¢è©¦å®˜æˆ–æŠ€è¡“å¯©é–±è€…ï¼Œå»ºè­°é‡é»é—œæ³¨ä»¥ä¸‹æª”æ¡ˆï¼š

### 1. æ¶æ§‹è¨­è¨ˆèƒ½åŠ›

- `admin-platform-vue/src/api/services/ServiceFactory.ts` - ä¾è³´æ³¨å…¥æ¨¡å¼å¯¦ä½œ
- `admin-platform-vue/src/composables/data-table-actions/` - å¯é‡ç”¨æ¶æ§‹æ¨¡å¼
- `admin-platform-vue/src/lib/queryClient.ts` - Vue Query éšå±¤å¼å¿«å–ç®¡ç†

### 2. å‰ç«¯å·¥ç¨‹åŒ–

- `admin-platform-vue/src/components/data-table-common/` - Headless UI è¨­è¨ˆ
- `admin-platform-vue/src/components/charts/pure/` - Unovis åœ–è¡¨æ•´åˆ
- `admin-platform-vue/tests/` - 471 æ¸¬è©¦å…¨éƒ¨é€šéï¼ˆ100% é€šéç‡ï¼‰

### 3. å¾Œç«¯é‚è¼¯ä¿è­·

- `supabase/migrations/20250723200000_layered_attribution_implementation.sql` - è¤‡é›œè¦–åœ–è¨­è¨ˆ
- `supabase/migrations/20250731170000_fix_notification_triggers_for_real_tables.sql` - è§¸ç™¼å™¨æ¶æ§‹
- `supabase/functions/business-health-analytics/` - Edge Function å•†æ¥­é‚è¼¯

### 4. å•é¡Œè§£æ±ºèƒ½åŠ›

- `docs/04-guides/dev-notes/NOTIFICATION_SYSTEM_OVERVIEW.md` - é€šçŸ¥ç³»çµ±ä¿®å¾©è¨˜éŒ„
- `docs/04-guides/dev-notes/ROUTER_SESSION_PERFORMANCE_OPTIMIZATION.md` - æ•ˆèƒ½æœ€ä½³åŒ–æ¡ˆä¾‹
- `docs/04-guides/dev-notes/SERVICE_FACTORY_ARCHITECTURE.md` - æ¶æ§‹é‡æ§‹æ€è·¯

### 5. DevOps å¯¦è¸

- `scripts/health-check.sh` - ç³»çµ±å¥åº·æª¢æŸ¥è…³æœ¬ï¼ˆ167 è¡Œï¼‰
- `scripts/prod.sh` - ç”Ÿç”¢ç’°å¢ƒç®¡ç†è…³æœ¬ï¼ˆ175 è¡Œï¼‰
- `.github/workflows/` - CI/CD ç®¡ç·šè¨­å®šï¼ˆè‹¥éƒ¨ç½²ï¼‰

---

## ğŸ“ˆ å°ˆæ¡ˆçµ±è¨ˆ

> **ğŸ“Œ èªªæ˜**ï¼šæ­¤ Repository ç‚ºç²¾ç°¡å±•ç¤ºç‰ˆæœ¬ï¼Œèšç„¦æ ¸å¿ƒåŠŸèƒ½èˆ‡æ¶æ§‹è¨­è¨ˆã€‚ä»¥ä¸‹çµ±è¨ˆæ•¸æ“šåæ˜ å®Œæ•´ç³»çµ±çš„æŠ€è¡“è¦æ¨¡èˆ‡è¤‡é›œåº¦ã€‚

### ç¨‹å¼ç¢¼è¦æ¨¡

| é¡åˆ¥ | æª”æ¡ˆæ•¸ | ç¨‹å¼ç¢¼è¡Œæ•¸ | èªªæ˜ |
|------|--------|----------|------|
| **å‰ç«¯çµ„ä»¶** | 400+ å€‹ | ~100,000 è¡Œ | å®Œæ•´çµ„ä»¶é«”ç³» |
| **Composables** | 80+ å€‹ | ~15,000 è¡Œ | æ¥­å‹™é‚è¼¯å±¤ |
| **API Services** | 8 å€‹ | ~2,000 è¡Œ | ServiceFactory æœå‹™ |
| **é é¢çµ„ä»¶** | 45 å€‹ | ~10,000 è¡Œ | å®Œæ•´æ¥­å‹™é é¢ |
| **æ¸¬è©¦** | 41 å€‹æª”æ¡ˆ | ~12,000 è¡Œ | 471 æ¸¬è©¦ï¼ˆ100% é€šéï¼‰ |
| **Migrations** | 195 å€‹ | ~50,000 è¡Œ | å®Œæ•´è³‡æ–™åº«æ¼”é€² |
| **Edge Functions** | 14 å€‹ | ~5,000 è¡Œ | ä¼ºæœå™¨ç«¯é‚è¼¯ |
| **æ–‡ä»¶** | 261 å€‹æª”æ¡ˆ | ~80,000 è¡Œ | å®Œæ•´æŠ€è¡“æ–‡ä»¶ |

### æŠ€è¡“æ·±åº¦æŒ‡æ¨™

- **TypeScript è¦†è“‹ç‡**: 100%ï¼ˆæ‰€æœ‰æ¥­å‹™ç¨‹å¼ç¢¼ï¼‰
- **æ¸¬è©¦é€šéç‡**: 100%ï¼ˆ471/471 æ¸¬è©¦ï¼‰
- **ESLint åˆè¦**: 0 éŒ¯èª¤
- **æ–‡ä»¶å®Œæ•´åº¦**: æ ¸å¿ƒåŠŸèƒ½ 100% è¦†è“‹

---

## ğŸ“¬ è¯çµ¡æ–¹å¼

**é–‹ç™¼è€…**: [æ¥Šé›…å–¬]

- ğŸ“§ Email: chiaoyyc@gmail.com
- ğŸ’¼ LinkedIn: [www.linkedin.com/in/yachiaoyang](https://www.linkedin.com/in/yachiaoyang)
- ğŸ™ GitHub: [github.com/chiao-yyc](https://github.com/chiao-yyc)
- ğŸŒ å€‹äººç¶²ç«™: [yachiaoyang.dev/](https://yachiaoyang.dev/)

